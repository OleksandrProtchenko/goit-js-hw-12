{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst BASE_URL = 'https://pixabay.com/api';\nconst API_KEY = import.meta.env.VITE_PIXABEY_KEY;\nexport const perPage = 15;\naxios.defaults.baseURL = BASE_URL;\n\nexport async function request(query, page) {\n  const response = await axios({\n    url: BASE_URL,\n    method: 'get',\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n  return response.data;\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst gallery = document.querySelector('.gallery');\nexport const loadBtn = document.querySelector('.js-gallery-btn');\nconst loader = document.querySelector('.loader');\n\nlet lightBox = null;\n\nexport function createGallery(images) {\n  const markup = images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n            <li class=\"list-item\">\n                <a href=\"${largeImageURL}\"><img src=\"${webformatURL}\" alt=\"${tags}\" /></a>\n                <div class=\"list-content\">\n                    <div>\n                        <h2 class=\"likes\">Likes</h2>\n                        <p class=\"count-likes\">${likes}</p>\n                    </div>\n                    <div>\n                        <h2 class=\"views\">Views</h2>\n                        <p class=\"count-views\">${views}</p>\n                    </div>\n                    <div>\n                        <h2 class=\"comments\">Comments</h2>\n                        <p class=\"count-comments\">${comments}</p>\n                    </div>\n                    <div>\n                        <h2 class=\"downloads\">Downloads</h2>\n                        <p class=\"count-downloads\">${downloads}</p>\n                    </div>\n                </div>\n            </li>\n        `;\n      }\n    )\n    .join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  if (lightBox) {\n    lightBox.refresh();\n  } else {\n    lightBox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  }\n}\nexport function clearGallery() {\n  gallery.innerHTML = '';\n}\nexport function showLoader() {\n  loader.style.display = 'inline-block';\n}\nexport function hideLoader() {\n  loader.style.display = 'none';\n}\nexport function showLoadMoreButton() {\n  loadBtn.classList.remove('shown');\n  return;\n}\nexport function hideLoadMoreButton() {\n  loadBtn.classList.add('shown');\n  return;\n}\n","import { perPage, request } from './js/pixabay-api';\nimport {\n  createGallery,\n  hideLoader,\n  hideLoadMoreButton,\n  loadBtn,\n  showLoader,\n  showLoadMoreButton,\n} from './js/render-functions';\nimport { clearGallery } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.form');\n\nform.addEventListener('submit', onSubmitForm);\nloadBtn.addEventListener('click', onLoadMoreClick);\n\nlet resInput = '';\nlet pageNum = 1;\nlet totalPages = 0;\n\nhideLoader();\n\nasync function onSubmitForm(event) {\n  event.preventDefault();\n  pageNum = 1;\n\n  hideLoadMoreButton();\n  clearGallery();\n\n  resInput = new FormData(form).get('search-text').trim();\n\n  try {\n    if (resInput === '') {\n      rejectUserInput();\n      return;\n    }\n\n    showLoader();\n\n    const { hits, totalHits } = await request(resInput, pageNum);\n    totalPages = Math.ceil(totalHits / perPage);\n\n    if (!hits || hits.length === 0) {\n      rejectEmptyRequest();\n      return;\n    }\n\n    createGallery(hits);\n\n    if (pageNum < totalPages) {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    hideLoadMoreButton();\n    console.log(error.message);\n    displayToast(\n      'Sorry, there are no images matching your search query. Please try again!',\n      'error'\n    );\n  } finally {\n    form.reset();\n    hideLoader();\n  }\n}\n\nasync function onLoadMoreClick() {\n  try {\n    showLoader();\n    pageNum += 1;\n    const { hits } = await request(resInput, pageNum);\n\n    if (pageNum === totalPages) {\n      displayToast(\n        \"We're sorry, but you've reached the end of search results.\",\n        'info'\n      );\n      hideLoadMoreButton();\n    }\n\n    createGallery(hits);\n    scrollDown();\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader();\n  }\n}\n\n//? Helper functions\n\nfunction displayToast(message, toastType = 'error') {\n  iziToast.settings({\n    position: `topRight`,\n    maxWidth: `432px`,\n    messageColor: `#ffffff`,\n  });\n  switch (toastType) {\n    case 'error':\n      iziToast.error({\n        message: message,\n      });\n      break;\n    case 'info':\n      iziToast.info({\n        message: message,\n      });\n      break;\n    default:\n      break;\n  }\n}\n\nfunction rejectUserInput() {\n  displayToast('Please enter a search query!', 'error');\n  hideLoadMoreButton();\n  hideLoader();\n  clearGallery();\n}\n\nfunction rejectEmptyRequest() {\n  displayToast(\n    'Sorry, there are no images matching your search query. Please try again!',\n    'error'\n  );\n  hideLoader();\n}\n\nfunction scrollDown() {\n  const el = document.querySelector('.gallery');\n  const liEl = el.firstElementChild;\n\n  if (!liEl) return;\n\n  const { height } = liEl.getBoundingClientRect();\n\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["BASE_URL","API_KEY","perPage","axios","request","query","page","gallery","loadBtn","loader","lightBox","createGallery","images","markup","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","form","onSubmitForm","onLoadMoreClick","resInput","pageNum","totalPages","event","rejectUserInput","hits","totalHits","rejectEmptyRequest","error","displayToast","scrollDown","message","toastType","iziToast","liEl","height"],"mappings":"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"}